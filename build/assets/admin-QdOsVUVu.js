import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as se,i as de,a as v,j as H,k as ce,l as _,d as j,m as me,q as ue,n as pe,c as ge,p as fe}from"./firebaseConfig-9y8MQOtI.js";let d=[],y=[],S=null;const X=document.getElementById("loginScreen"),G=document.getElementById("adminDashboard"),D=document.getElementById("loginForm"),q=document.getElementById("loginError"),ye=document.getElementById("logoutBtn"),he=document.getElementById("adminUserEmail"),J=document.getElementById("searchInput"),f=document.getElementById("filterDropdown"),ve=f.querySelector(".dropdown-selected");f.querySelector(".dropdown-options");const W=f.querySelectorAll(".dropdown-option"),be=document.getElementById("selectedFilterText");let K="all";const Ee=document.getElementById("exportCSV"),we=document.getElementById("exportJSON"),P=document.getElementById("tableBody"),Ie=document.getElementById("totalRegistrations"),Le=document.getElementById("individualCount"),Ce=document.getElementById("teamCount"),ke=document.getElementById("totalParticipants"),L=document.getElementById("togglePassword"),M=document.getElementById("adminPassword");L&&M&&L.addEventListener("click",()=>{const e=M.getAttribute("type")==="password"?"text":"password";M.setAttribute("type",e),e==="text"?L.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye-off"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>':L.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'});se(v,async e=>{e?await Q(e)?(S=e,Be(),$e()):(await H(v),R("Access denied. Admin privileges required."),F()):F()});D.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("adminEmail").value,a=document.getElementById("adminPassword").value,n=D.querySelector('button[type="submit"]'),o=n.textContent;try{q.textContent="",n.textContent="Signing in...",n.disabled=!0,n.style.opacity="0.7",n.style.cursor="not-allowed";const r=await de(v,t,a);await Q(r.user)||(await H(v),R("Access denied. Admin privileges required."),n.textContent=o,n.disabled=!1,n.style.opacity="",n.style.cursor="")}catch(r){console.error("Login error:",r),R(xe(r.code)),n.textContent=o,n.disabled=!1,n.style.opacity="",n.style.cursor=""}});ye.addEventListener("click",async()=>{try{await H(v),F()}catch(e){console.error("Logout error:",e)}});async function Q(e){try{console.log("Checking admin role for:",e.email);const t=await ce(_(j,"users",e.uid));if(console.log("User document exists:",t.exists()),t.exists()&&t.data().role==="admin")return console.log("User has admin role in Firestore"),!0;const n=["admin@hackathon.com","admin@example.com","hackathon2026@gmail.com"].includes(e.email);return console.log("Checking email list. Is admin:",n),n}catch(t){return console.error("Error checking admin role:",t),!1}}function F(){X.classList.remove("hidden"),G.classList.add("hidden"),D.reset(),q.textContent=""}function Be(){X.classList.add("hidden"),G.classList.remove("hidden"),S&&(he.textContent=S.email)}function R(e){q.textContent=e}function xe(e){switch(e){case"auth/invalid-email":return"Invalid email address";case"auth/user-disabled":return"This account has been disabled";case"auth/user-not-found":return"No account found with this email";case"auth/wrong-password":return"Incorrect password";case"auth/invalid-credential":return"Invalid email or password";default:return"Login failed. Please try again."}}function $e(){const e=ue(ge(j,"registrations"),pe("timestamp","desc"));fe(e,t=>{d=[],t.forEach(a=>{d.push({id:a.id,...a.data()})}),y=[...d],Te(),Z()},t=>{console.error("Error loading registrations:",t),P.innerHTML=`
            <tr>
                <td colspan="8" style="text-align: center; padding: 2rem; color: var(--error);">
                    Error loading data. Please refresh the page.
                </td>
            </tr>
        `})}function Te(){const e=d.length,t=d.filter(o=>o.participationType==="individual").length,a=d.filter(o=>o.participationType==="team").length;let n=t;d.forEach(o=>{o.participationType==="team"&&o.teamSize&&(n+=parseInt(o.teamSize)||0)}),Ie.textContent=e,Le.textContent=t,Ce.textContent=a,ke.textContent=n}function Z(){if(y.length===0){P.innerHTML=`
            <tr>
                <td colspan="8" style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                    No registrations found
                </td>
            </tr>
        `;return}P.innerHTML=y.map(e=>`
        <tr>
            <td style="font-weight: 600; color: var(--electric-blue);">${i(e.registrationId||"N/A")}</td>
            <td>${O(e.timestamp)}</td>
            <td>${i(e.fullName||"N/A")}</td>
            <td>${i(e.email||"N/A")}</td>
            <td>${i(e.mobile||"N/A")}</td>
            <td>${i(e.collegeName||"N/A")}</td>
            <td>
                <span class="type-badge type-${e.participationType}">
                    ${e.participationType==="individual"?"ğŸ‘¤ Individual":"ğŸ‘¥ Team"}
                </span>
            </td>
            <td>${i(e.teamName||"-")}</td>
            <td>
                <button class="view-btn" onclick="viewDetails('${e.id}')">View</button>
                <button class="delete-btn" onclick="deleteRegistration('${e.id}', '${e.registrationId||"N/A"}')">Delete</button>
            </td>
        </tr>
    `).join("")}J.addEventListener("input",ee);ve.addEventListener("click",e=>{e.stopPropagation(),f.classList.toggle("open")});document.addEventListener("click",e=>{f.contains(e.target)||f.classList.remove("open")});W.forEach(e=>{e.addEventListener("click",()=>{W.forEach(t=>t.classList.remove("active")),e.classList.add("active"),be.textContent=e.textContent,K=e.getAttribute("data-value"),f.classList.remove("open"),ee()})});function ee(){const e=J.value.toLowerCase(),t=K;y=d.filter(a=>t!=="all"&&a.participationType!==t?!1:e?[a.fullName,a.email,a.mobile,a.collegeName,a.teamName,a.department,a.university].map(o=>(o||"").toLowerCase()).some(o=>o.includes(e)):!0),Z()}Ee.addEventListener("click",()=>{const e=Me(y);te(e,"registrations.csv","text/csv")});we.addEventListener("click",()=>{const e=JSON.stringify(y,null,2);te(e,"registrations.json","application/json")});function Me(e){if(e.length===0)return"";const t=["Reg ID","Timestamp","Name","Email","Mobile","Alt Mobile","Parent Name","Parent Mobile","College","Location","University","Department","Year","Type","Team Name","Team Size","Leader Name","Leader Email","Team Member Details","LinkedIn","Portfolio","GitHub","Hear About","Special Requirements"],a=e.map(n=>[n.registrationId||"N/A",O(n.timestamp),n.fullName||"",n.email||"",n.mobile||"",n.altMobile||"",n.parentName||"",n.parentMobile||"",n.collegeName||"",n.collegeLocation||"",n.university||"",n.department||"",n.yearOfStudy||"",n.participationType||"",n.teamName||"",n.teamSize||"",n.leaderName||"",n.leaderEmail||"",n.teamMembers?n.teamMembers.map(o=>`${o.name} (${o.email||"No Email"}, ${o.mobile||"No Mobile"}, ${o.linkedin||"No LinkedIn"})`).join(" | "):"",n.linkedin||"",n.portfolio||"",n.github||"",n.hearAbout||"",n.specialRequirements||""].map(o=>`"${String(o).replace(/"/g,'""')}"`));return[t.join(","),...a.map(n=>n.join(","))].join(`
`)}function te(e,t,a){const n=new Blob([e],{type:a}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}let C=!1,p=0,g=0,b=0,E=0,h=null;const N=(e,t=0,a=100)=>Math.min(Math.max(e,t),a),U=(e,t=3)=>parseFloat(e.toFixed(t)),Y=(e,t,a,n,o)=>U(n+(o-n)*(e-t)/(a-t));function ne(e,t){const a=document.getElementById("detailsModal"),n=document.getElementById("pcCard");if(!a||!n)return;const o=n.clientWidth||1,r=n.clientHeight||1,c=N(100/o*e),m=N(100/r*t),B=c-50,w=m-50,u={"--pointer-x":`${c}%`,"--pointer-y":`${m}%`,"--background-x":`${Y(c,0,100,35,65)}%`,"--background-y":`${Y(m,0,100,35,65)}%`,"--pointer-from-center":`${N(Math.hypot(m-50,c-50)/50,0,1)}`,"--pointer-from-top":`${m/100}`,"--pointer-from-left":`${c/100}`,"--rotate-x":`${U(-(B/6))}deg`,"--rotate-y":`${U(w/5)}deg`};for(const[I,x]of Object.entries(u))a.style.setProperty(I,x)}function ae(e){if(!C)return;const t=.12;p+=(b-p)*t,g+=(E-g)*t,ne(p,g),(Math.abs(b-p)>.05||Math.abs(E-g)>.05)&&(h=requestAnimationFrame(ae))}function oe(){C||(C=!0,h=requestAnimationFrame(ae))}function Ne(){C=!1,h&&(cancelAnimationFrame(h),h=null)}window.viewDetails=function(e){const t=d.find(l=>l.id===e);if(!t)return;const a=document.getElementById("detailsModal"),n=document.getElementById("pcCard"),o=document.getElementById("pcCardWrapper");document.getElementById("pcRegId").textContent=t.registrationId||"N/A",document.getElementById("pcUserName").textContent=t.fullName||"Unknown",document.getElementById("pcUserTitle").textContent=`${t.collegeName||""} â€¢ ${t.department||""}`;const r=document.getElementById("pcAvatar"),c=(t.fullName||"U").charAt(0).toUpperCase();r.innerHTML=`<span style="font-size: 3rem; background: linear-gradient(135deg, var(--bright-red), var(--electric-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${c}</span>`;const m=document.getElementById("pcTypeBadge");m.innerHTML=`
        <span class="type-badge type-${t.participationType}">
            ${t.participationType==="individual"?"ğŸ‘¤ Individual":"ğŸ‘¥ Team"}
        </span>
    `;const B=document.getElementById("pcDetailsGrid");let w="";const u=[{label:"ğŸ“… Registered",value:O(t.timestamp)},{label:"ğŸ“§ Email",value:t.email},{label:"ğŸ“± Mobile",value:t.mobile},{label:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ Parent Name",value:t.parentName},{label:"ğŸ“ Parent WhatsApp",value:t.parentMobile},{label:"ğŸ“ Institution",value:t.collegeName},{label:"ğŸ›ï¸ Inst. Type",value:t.institutionType?t.institutionType==="university"?"University":"Autonomous College":null},{label:"ğŸ¯ Department",value:t.department},{label:"ğŸ“š Year",value:t.yearOfStudy?`Year ${t.yearOfStudy}`:null}];t.participationType==="team"&&u.push({label:"ğŸ‘¥ Team Name",value:t.teamName},{label:"ğŸ“Š Team Size",value:t.teamSize},{label:"ğŸ‘‘ Leader",value:t.leaderName},{label:"âœ‰ï¸ Leader Email",value:t.leaderEmail}),t.linkedin&&u.push({label:"ğŸ’¼ LinkedIn",value:`<a href="${i(t.linkedin)}" target="_blank">View Profile â†’</a>`}),t.portfolio&&u.push({label:"ğŸŒ Portfolio",value:`<a href="${i(t.portfolio)}" target="_blank">Visit Site â†’</a>`}),t.github&&u.push({label:"ğŸ™ GitHub",value:`<a href="${i(t.github)}" target="_blank">View Repos â†’</a>`}),u.forEach(l=>{l.value&&(w+=`
                <div class="pc-detail-item">
                    <span class="pc-detail-label">${l.label}</span>
                    <span class="pc-detail-value">${l.value.includes("<a")?l.value:i(l.value)}</span>
                </div>
            `)}),B.innerHTML=w;const I=document.getElementById("pcTeamSection"),x=document.getElementById("pcTeamMembers");if(t.participationType==="team"&&t.teamMembers&&t.teamMembers.length>0){I.classList.remove("hidden");let l="";t.teamMembers.forEach((s,T)=>{l+=`
                <div class="pc-team-member">
                    <div class="pc-team-member-name">${T+1}. ${i(s.name||"Member")}</div>
                    <div class="pc-team-member-details">
                        ${s.email?`ğŸ“§ ${i(s.email)}`:""}
                        ${s.mobile?` â€¢ ğŸ“± ${i(s.mobile)}`:""}
                        ${s.linkedin?` â€¢ ğŸ’¼ <a href="${i(s.linkedin)}" target="_blank" style="color: var(--electric-blue); text-decoration: none; border-bottom: 1px solid rgba(0, 169, 255, 0.3);">LinkedIn â†’</a>`:""}
                    </div>
                </div>
            `}),x.innerHTML=l}else I.classList.add("hidden");const V=document.getElementById("pcCollegeIdSection"),$=document.getElementById("pcCollegeIdContent");if(t.collegeIdUrl){V.classList.remove("hidden");const l=t.collegeIdFileName||"College ID",s=l.match(/\.(jpg|jpeg|png|gif|webp)$/i),T=l.match(/\.pdf$/i);s?$.innerHTML=`
                <div class="pc-college-id-image-wrapper">
                    <img src="${i(t.collegeIdUrl)}" alt="College ID Card" class="pc-college-id-image" onclick="window.open('${i(t.collegeIdUrl)}', '_blank')">
                    <p class="pc-college-id-filename">${i(l)}</p>
                    <a href="${i(t.collegeIdUrl)}" target="_blank" class="pc-college-id-link">ğŸ” View Full Size</a>
                </div>
            `:T?$.innerHTML=`
                <div class="pc-college-id-pdf-wrapper">
                    <span class="pc-college-id-pdf-icon">ğŸ“„</span>
                    <p class="pc-college-id-filename">${i(l)}</p>
                    <a href="${i(t.collegeIdUrl)}" target="_blank" class="pc-college-id-link">ğŸ“¥ Download PDF</a>
                </div>
            `:$.innerHTML=`
                <div class="pc-college-id-file-wrapper">
                    <span class="pc-college-id-file-icon">ğŸ“</span>
                    <p class="pc-college-id-filename">${i(l)}</p>
                    <a href="${i(t.collegeIdUrl)}" target="_blank" class="pc-college-id-link">ğŸ“¥ Download File</a>
                </div>
            `}else V.classList.add("hidden");a.classList.remove("hidden"),o.classList.add("active"),document.body.style.overflow="hidden";const z=n.getBoundingClientRect();p=z.width/2,g=z.height/2,b=p,E=g,ne(p,g),n.addEventListener("pointermove",ie),n.addEventListener("pointerenter",le),n.addEventListener("pointerleave",re)};function ie(e){const a=document.getElementById("pcCard").getBoundingClientRect();b=e.clientX-a.left,E=e.clientY-a.top,oe()}function le(){document.getElementById("pcCardWrapper").classList.add("active")}function re(){const e=document.getElementById("pcCard");b=e.clientWidth/2,E=e.clientHeight/2,oe()}window.closeDetailsModal=function(){const e=document.getElementById("detailsModal"),t=document.getElementById("pcCard"),a=document.getElementById("pcCardWrapper");t.removeEventListener("pointermove",ie),t.removeEventListener("pointerenter",le),t.removeEventListener("pointerleave",re),Ne(),a.classList.remove("active"),e.classList.add("hidden"),document.body.style.overflow=""};const A=document.getElementById("detailsModal");A&&A.addEventListener("click",e=>{(e.target===A||e.target.id==="pcCardWrapper")&&closeDetailsModal()});let k=null;window.deleteRegistration=function(e,t){k=e,document.getElementById("deleteRegId").textContent=t||"this user",document.getElementById("deleteModal").classList.remove("hidden"),document.body.style.overflow="hidden"};window.closeDeleteModal=function(){document.getElementById("deleteModal").classList.add("hidden"),document.body.style.overflow="",k=null};window.confirmDelete=async function(){if(k)try{const e=document.querySelector(".delete-confirm-btn"),t=e.textContent;e.textContent="Deleting...",e.disabled=!0,await me(_(j,"registrations",k)),closeDeleteModal()}catch(e){console.error("Error deleting document: ",e),alert("Error deleting registration: "+e.message)}finally{const e=document.querySelector(".delete-confirm-btn");e&&(e.textContent="Delete Permanently",e.disabled=!1)}};function O(e){if(!e)return"N/A";let t;return e.toDate?t=e.toDate():e instanceof Date?t=e:t=new Date(e),t.toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function i(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}
