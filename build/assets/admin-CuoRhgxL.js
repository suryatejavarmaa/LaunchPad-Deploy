import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as re,i as se,a as v,j as H,k as de,l as _,d as P,m as ce,q as me,n as ue,c as pe,p as ge}from"./firebaseConfig-SQs8Zglo.js";let s=[],y=[],S=null;const W=document.getElementById("loginScreen"),X=document.getElementById("adminDashboard"),A=document.getElementById("loginForm"),j=document.getElementById("loginError"),fe=document.getElementById("logoutBtn"),ye=document.getElementById("adminUserEmail"),G=document.getElementById("searchInput"),f=document.getElementById("filterDropdown"),he=f.querySelector(".dropdown-selected");f.querySelector(".dropdown-options");const z=f.querySelectorAll(".dropdown-option"),ve=document.getElementById("selectedFilterText");let J="all";const be=document.getElementById("exportCSV"),we=document.getElementById("exportJSON"),D=document.getElementById("tableBody"),Ee=document.getElementById("totalRegistrations"),Ie=document.getElementById("individualCount"),Le=document.getElementById("teamCount"),Ce=document.getElementById("totalParticipants"),L=document.getElementById("togglePassword"),M=document.getElementById("adminPassword");L&&M&&L.addEventListener("click",()=>{const e=M.getAttribute("type")==="password"?"text":"password";M.setAttribute("type",e),e==="text"?L.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye-off"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>':L.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'});re(v,async e=>{e?await K(e)?(S=e,Be(),Te()):(await H(v),R("Access denied. Admin privileges required."),F()):F()});A.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("adminEmail").value,a=document.getElementById("adminPassword").value,n=A.querySelector('button[type="submit"]'),o=n.textContent;try{j.textContent="",n.textContent="Signing in...",n.disabled=!0,n.style.opacity="0.7",n.style.cursor="not-allowed";const r=await se(v,t,a);await K(r.user)||(await H(v),R("Access denied. Admin privileges required."),n.textContent=o,n.disabled=!1,n.style.opacity="",n.style.cursor="")}catch(r){console.error("Login error:",r),R(xe(r.code)),n.textContent=o,n.disabled=!1,n.style.opacity="",n.style.cursor=""}});fe.addEventListener("click",async()=>{try{await H(v),F()}catch(e){console.error("Logout error:",e)}});async function K(e){try{console.log("Checking admin role for:",e.email);const t=await de(_(P,"users",e.uid));if(console.log("User document exists:",t.exists()),t.exists()&&t.data().role==="admin")return console.log("User has admin role in Firestore"),!0;const n=["admin@hackathon.com","admin@example.com","hackathon2026@gmail.com"].includes(e.email);return console.log("Checking email list. Is admin:",n),n}catch(t){return console.error("Error checking admin role:",t),!1}}function F(){W.classList.remove("hidden"),X.classList.add("hidden"),A.reset(),j.textContent=""}function Be(){W.classList.add("hidden"),X.classList.remove("hidden"),S&&(ye.textContent=S.email)}function R(e){j.textContent=e}function xe(e){switch(e){case"auth/invalid-email":return"Invalid email address";case"auth/user-disabled":return"This account has been disabled";case"auth/user-not-found":return"No account found with this email";case"auth/wrong-password":return"Incorrect password";case"auth/invalid-credential":return"Invalid email or password";default:return"Login failed. Please try again."}}function Te(){const e=me(pe(P,"registrations"),ue("timestamp","desc"));ge(e,t=>{s=[],t.forEach(a=>{s.push({id:a.id,...a.data()})}),y=[...s],ke(),Q()},t=>{console.error("Error loading registrations:",t),D.innerHTML=`
            <tr>
                <td colspan="8" style="text-align: center; padding: 2rem; color: var(--error);">
                    Error loading data. Please refresh the page.
                </td>
            </tr>
        `})}function ke(){const e=s.length,t=s.filter(o=>o.participationType==="individual").length,a=s.filter(o=>o.participationType==="team").length;let n=t;s.forEach(o=>{o.participationType==="team"&&o.teamSize&&(n+=parseInt(o.teamSize)||0)}),Ee.textContent=e,Ie.textContent=t,Le.textContent=a,Ce.textContent=n}function Q(){if(y.length===0){D.innerHTML=`
            <tr>
                <td colspan="8" style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                    No registrations found
                </td>
            </tr>
        `;return}D.innerHTML=y.map(e=>`
        <tr>
            <td style="font-weight: 600; color: var(--electric-blue);">${i(e.registrationId||"N/A")}</td>
            <td>${q(e.timestamp)}</td>
            <td>${i(e.fullName||"N/A")}</td>
            <td>${i(e.email||"N/A")}</td>
            <td>${i(e.mobile||"N/A")}</td>
            <td>${i(e.collegeName||"N/A")}</td>
            <td>
                <span class="type-badge type-${e.participationType}">
                    ${e.participationType==="individual"?"ğŸ‘¤ Individual":"ğŸ‘¥ Team"}
                </span>
            </td>
            <td>${i(e.teamName||"-")}</td>
            <td>
                <button class="view-btn" onclick="viewDetails('${e.id}')">View</button>
                <button class="delete-btn" onclick="deleteRegistration('${e.id}', '${e.registrationId||"N/A"}')">Delete</button>
            </td>
        </tr>
    `).join("")}G.addEventListener("input",Z);he.addEventListener("click",e=>{e.stopPropagation(),f.classList.toggle("open")});document.addEventListener("click",e=>{f.contains(e.target)||f.classList.remove("open")});z.forEach(e=>{e.addEventListener("click",()=>{z.forEach(t=>t.classList.remove("active")),e.classList.add("active"),ve.textContent=e.textContent,J=e.getAttribute("data-value"),f.classList.remove("open"),Z()})});function Z(){const e=G.value.toLowerCase(),t=J;y=s.filter(a=>t!=="all"&&a.participationType!==t?!1:e?[a.fullName,a.email,a.mobile,a.collegeName,a.teamName,a.department,a.university].map(o=>(o||"").toLowerCase()).some(o=>o.includes(e)):!0),Q()}be.addEventListener("click",()=>{const e=$e(y);ee(e,"registrations.csv","text/csv")});we.addEventListener("click",()=>{const e=JSON.stringify(y,null,2);ee(e,"registrations.json","application/json")});function $e(e){if(e.length===0)return"";const t=["Reg ID","Timestamp","Name","Email","Mobile","Alt Mobile","College","Location","University","Department","Year","Type","Team Name","Team Size","Leader Name","Leader Email","LinkedIn","Portfolio","GitHub","Hear About","Special Requirements"],a=e.map(n=>[n.registrationId||"N/A",q(n.timestamp),n.fullName||"",n.email||"",n.mobile||"",n.altMobile||"",n.collegeName||"",n.collegeLocation||"",n.university||"",n.department||"",n.yearOfStudy||"",n.participationType||"",n.teamName||"",n.teamSize||"",n.leaderName||"",n.leaderEmail||"",n.linkedin||"",n.portfolio||"",n.github||"",n.hearAbout||"",n.specialRequirements||""].map(o=>`"${String(o).replace(/"/g,'""')}"`));return[t.join(","),...a.map(n=>n.join(","))].join(`
`)}function ee(e,t,a){const n=new Blob([e],{type:a}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}let C=!1,p=0,g=0,b=0,w=0,h=null;const N=(e,t=0,a=100)=>Math.min(Math.max(e,t),a),U=(e,t=3)=>parseFloat(e.toFixed(t)),Y=(e,t,a,n,o)=>U(n+(o-n)*(e-t)/(a-t));function te(e,t){const a=document.getElementById("detailsModal"),n=document.getElementById("pcCard");if(!a||!n)return;const o=n.clientWidth||1,r=n.clientHeight||1,d=N(100/o*e),c=N(100/r*t),x=d-50,E=c-50,m={"--pointer-x":`${d}%`,"--pointer-y":`${c}%`,"--background-x":`${Y(d,0,100,35,65)}%`,"--background-y":`${Y(c,0,100,35,65)}%`,"--pointer-from-center":`${N(Math.hypot(c-50,d-50)/50,0,1)}`,"--pointer-from-top":`${c/100}`,"--pointer-from-left":`${d/100}`,"--rotate-x":`${U(-(x/6))}deg`,"--rotate-y":`${U(E/5)}deg`};for(const[I,T]of Object.entries(m))a.style.setProperty(I,T)}function ne(e){if(!C)return;const t=.12;p+=(b-p)*t,g+=(w-g)*t,te(p,g),(Math.abs(b-p)>.05||Math.abs(w-g)>.05)&&(h=requestAnimationFrame(ne))}function ae(){C||(C=!0,h=requestAnimationFrame(ne))}function Me(){C=!1,h&&(cancelAnimationFrame(h),h=null)}window.viewDetails=function(e){const t=s.find(l=>l.id===e);if(!t)return;const a=document.getElementById("detailsModal"),n=document.getElementById("pcCard"),o=document.getElementById("pcCardWrapper");document.getElementById("pcRegId").textContent=t.registrationId||"N/A",document.getElementById("pcUserName").textContent=t.fullName||"Unknown",document.getElementById("pcUserTitle").textContent=`${t.collegeName||""} â€¢ ${t.department||""}`;const r=document.getElementById("pcAvatar"),d=(t.fullName||"U").charAt(0).toUpperCase();r.innerHTML=`<span style="font-size: 3rem; background: linear-gradient(135deg, var(--bright-red), var(--electric-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${d}</span>`;const c=document.getElementById("pcTypeBadge");c.innerHTML=`
        <span class="type-badge type-${t.participationType}">
            ${t.participationType==="individual"?"ğŸ‘¤ Individual":"ğŸ‘¥ Team"}
        </span>
    `;const x=document.getElementById("pcDetailsGrid");let E="";const m=[{label:"ğŸ“… Registered",value:q(t.timestamp)},{label:"ğŸ“§ Email",value:t.email},{label:"ğŸ“± Mobile",value:t.mobile},{label:"ğŸ“ Institution",value:t.collegeName},{label:"ğŸ›ï¸ Inst. Type",value:t.institutionType?t.institutionType==="university"?"University":"Autonomous College":null},{label:"ğŸ¯ Department",value:t.department},{label:"ğŸ“š Year",value:t.yearOfStudy?`Year ${t.yearOfStudy}`:null}];t.participationType==="team"&&m.push({label:"ğŸ‘¥ Team Name",value:t.teamName},{label:"ğŸ“Š Team Size",value:t.teamSize},{label:"ğŸ‘‘ Leader",value:t.leaderName},{label:"âœ‰ï¸ Leader Email",value:t.leaderEmail}),t.linkedin&&m.push({label:"ğŸ’¼ LinkedIn",value:`<a href="${i(t.linkedin)}" target="_blank">View Profile â†’</a>`}),t.portfolio&&m.push({label:"ğŸŒ Portfolio",value:`<a href="${i(t.portfolio)}" target="_blank">Visit Site â†’</a>`}),t.github&&m.push({label:"ğŸ™ GitHub",value:`<a href="${i(t.github)}" target="_blank">View Repos â†’</a>`}),m.forEach(l=>{l.value&&(E+=`
                <div class="pc-detail-item">
                    <span class="pc-detail-label">${l.label}</span>
                    <span class="pc-detail-value">${l.value.includes("<a")?l.value:i(l.value)}</span>
                </div>
            `)}),x.innerHTML=E;const I=document.getElementById("pcTeamSection"),T=document.getElementById("pcTeamMembers");if(t.participationType==="team"&&t.teamMembers&&t.teamMembers.length>0){I.classList.remove("hidden");let l="";t.teamMembers.forEach((u,$)=>{l+=`
                <div class="pc-team-member">
                    <div class="pc-team-member-name">${$+1}. ${i(u.name||"Member")}</div>
                    <div class="pc-team-member-details">
                        ${u.email?`ğŸ“§ ${i(u.email)}`:""}
                        ${u.mobile?` â€¢ ğŸ“± ${i(u.mobile)}`:""}
                    </div>
                </div>
            `}),T.innerHTML=l}else I.classList.add("hidden");const O=document.getElementById("pcCollegeIdSection"),k=document.getElementById("pcCollegeIdContent");if(t.collegeIdUrl){O.classList.remove("hidden");const l=t.collegeIdFileName||"College ID",u=l.match(/\.(jpg|jpeg|png|gif|webp)$/i),$=l.match(/\.pdf$/i);u?k.innerHTML=`
                <div class="pc-college-id-image-wrapper">
                    <img src="${i(t.collegeIdUrl)}" alt="College ID Card" class="pc-college-id-image" onclick="window.open('${i(t.collegeIdUrl)}', '_blank')">
                    <p class="pc-college-id-filename">${i(l)}</p>
                    <a href="${i(t.collegeIdUrl)}" target="_blank" class="pc-college-id-link">ğŸ” View Full Size</a>
                </div>
            `:$?k.innerHTML=`
                <div class="pc-college-id-pdf-wrapper">
                    <span class="pc-college-id-pdf-icon">ğŸ“„</span>
                    <p class="pc-college-id-filename">${i(l)}</p>
                    <a href="${i(t.collegeIdUrl)}" target="_blank" class="pc-college-id-link">ğŸ“¥ Download PDF</a>
                </div>
            `:k.innerHTML=`
                <div class="pc-college-id-file-wrapper">
                    <span class="pc-college-id-file-icon">ğŸ“</span>
                    <p class="pc-college-id-filename">${i(l)}</p>
                    <a href="${i(t.collegeIdUrl)}" target="_blank" class="pc-college-id-link">ğŸ“¥ Download File</a>
                </div>
            `}else O.classList.add("hidden");a.classList.remove("hidden"),o.classList.add("active"),document.body.style.overflow="hidden";const V=n.getBoundingClientRect();p=V.width/2,g=V.height/2,b=p,w=g,te(p,g),n.addEventListener("pointermove",oe),n.addEventListener("pointerenter",ie),n.addEventListener("pointerleave",le)};function oe(e){const a=document.getElementById("pcCard").getBoundingClientRect();b=e.clientX-a.left,w=e.clientY-a.top,ae()}function ie(){document.getElementById("pcCardWrapper").classList.add("active")}function le(){const e=document.getElementById("pcCard");b=e.clientWidth/2,w=e.clientHeight/2,ae()}window.closeDetailsModal=function(){const e=document.getElementById("detailsModal"),t=document.getElementById("pcCard"),a=document.getElementById("pcCardWrapper");t.removeEventListener("pointermove",oe),t.removeEventListener("pointerenter",ie),t.removeEventListener("pointerleave",le),Me(),a.classList.remove("active"),e.classList.add("hidden"),document.body.style.overflow=""};let B=null;window.deleteRegistration=function(e,t){B=e,document.getElementById("deleteRegId").textContent=t||"this user",document.getElementById("deleteModal").classList.remove("hidden"),document.body.style.overflow="hidden"};window.closeDeleteModal=function(){document.getElementById("deleteModal").classList.add("hidden"),document.body.style.overflow="",B=null};window.confirmDelete=async function(){if(B)try{const e=document.querySelector(".delete-confirm-btn"),t=e.textContent;e.textContent="Deleting...",e.disabled=!0,await ce(_(P,"registrations",B)),closeDeleteModal()}catch(e){console.error("Error deleting document: ",e),alert("Error deleting registration: "+e.message)}finally{const e=document.querySelector(".delete-confirm-btn");e&&(e.textContent="Delete Permanently",e.disabled=!1)}};function q(e){if(!e)return"N/A";let t;return e.toDate?t=e.toDate():e instanceof Date?t=e:t=new Date(e),t.toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function i(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}
